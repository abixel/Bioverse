

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Example 1: Finding the habitable zone &mdash; Bioverse 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 2: Detecting the age-oxygen correlation" href="Example2.html" />
    <link rel="prev" title="Tutorial 2: Simulating survey datasets" href="GettingStarted2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Bioverse
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../table.html">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module1.html">Simulated planetary systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module2.html">Simulated survey datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module3.html">Hypothesis testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module4.html">Computing statistical power</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted1.html">Tutorial 1: Generating planetary systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted2.html">Tutorial 2: Simulating survey datasets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 1: Finding the habitable zone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Injecting-the-statistical-effect">Injecting the statistical effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Defining-the-hypothesis">Defining the hypothesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Computing-statistical-power">Computing statistical power</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Example2.html">Example 2: Detecting the age-oxygen correlation</a></li>
</ul>
<p class="caption"><span class="caption-text">Full Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.analysis.html">bioverse.analysis module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.classes.html">bioverse.classes module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.constants.html">bioverse.constants module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.custom.html">bioverse.custom module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.functions.html">bioverse.functions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.generator.html">bioverse.generator module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.hypothesis.html">bioverse.hypothesis module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.plots.html">bioverse.plots module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.survey.html">bioverse.survey module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/bioverse.util.html">bioverse.util module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bioverse</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Example 1: Finding the habitable zone</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/Notebooks/Example1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<b>Note:</b> This example is available as an interactive Jupyter notebook in the file <code>Notebooks/Example1.ipynb</code>
</div><div class="section" id="Example-1:-Finding-the-habitable-zone">
<h1>Example 1: Finding the habitable zone<a class="headerlink" href="#Example-1:-Finding-the-habitable-zone" title="Permalink to this headline">¶</a></h1>
<p>In Section 6 of <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2021AJ....161..228B/abstract">Bixel &amp; Apai (2021)</a>, we propose that the concept of a “habitable zone” could be validated by searching for a region of space where planets with atmospheric water vapor are statistically more frequent.</p>
<p>In this example, you will use Bioverse to determine whether a <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019arXiv191206219T/abstract">LUVOIR</a>-like imaging survey could test this hypothesis.</p>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>First, we’ll import the Bioverse code:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Append the main Bioverse directory to the system path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;../../../&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span>

<span class="c1"># Import the relevant modules</span>
<span class="kn">from</span> <span class="nn">bioverse.survey</span> <span class="kn">import</span> <span class="n">ImagingSurvey</span>
<span class="kn">from</span> <span class="nn">bioverse.generator</span> <span class="kn">import</span> <span class="n">Generator</span>
<span class="kn">from</span> <span class="nn">bioverse.hypothesis</span> <span class="kn">import</span> <span class="n">Hypothesis</span>
<span class="kn">from</span> <span class="nn">bioverse</span> <span class="kn">import</span> <span class="n">analysis</span>

<span class="c1"># Import pyplot (for making plots later) and adjust some of its settings</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.</span>
</pre></div>
</div>
</div>
<p>For this example, we will use the LUVOIR-like imaging survey and host star catalog.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">generator</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="s1">&#39;imaging&#39;</span><span class="p">)</span>
<span class="n">survey</span> <span class="o">=</span> <span class="n">ImagingSurvey</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Injecting-the-statistical-effect">
<h2>Injecting the statistical effect<a class="headerlink" href="#Injecting-the-statistical-effect" title="Permalink to this headline">¶</a></h2>
<p>The first step is to inject the statistical effect we are searching for into the simulated planet population. Specifically, we will simulate the likelihood that a planet has atmospheric water vapor as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">habitable_zone_water</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f_water_habitable</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">f_water_nonhabitable</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="c1"># Non-habitable planets with atmospheres</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">**</span><span class="mf">0.25</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">][</span><span class="n">m1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">m1</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">f_water_nonhabitable</span>

    <span class="c1"># exo-Earth candidates</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;EEC&#39;</span><span class="p">]</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">][</span><span class="n">m2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">f_water_habitable</span>

    <span class="k">return</span> <span class="n">d</span>

<span class="n">generator</span><span class="o">.</span><span class="n">insert_step</span><span class="p">(</span><span class="n">habitable_zone_water</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, let’s make a simulated dataset using this modified Generator object and the imaging Survey. Let’s start with a relatively optimistic assumption that 75% of EECs are habitable and only 1% of non-EECs have “false positive” water vapor.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sample</span><span class="p">,</span> <span class="n">detected</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">survey</span><span class="o">.</span><span class="n">quickrun</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">f_water_habitable</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">f_water_nonhabitable</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s take a look at the simulated data set by plotting which planets have H2O versus their insolation. You might notice that planets within the habitable zone (approx 0.3 &lt; S &lt; 1.1) are more likely to have water-rich atmospheres.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;a_eff&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">]</span>

<span class="c1"># Now plot the water-rich/water-poor planets versus a_eff (in log-space)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;no H$_2$O&#39;</span><span class="p">,</span><span class="s1">&#39;has H$_2$O&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Semi-major axis (scaled) (AU)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="c1"># Highlight the boundaries of the habitable zone (water-rich planets should be more common here)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1.7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_Example1_9_0.svg" src="../_images/Notebooks_Example1_9_0.svg" /></div>
</div>
<p>The effect injected by <code class="docutils literal notranslate"><span class="pre">habitable_zone_water</span></code> is apparent in the dataset. But is this effect of high enough statistical significance to confirm the habitable zone hypothesis?</p>
</div>
<div class="section" id="Defining-the-hypothesis">
<h2>Defining the hypothesis<a class="headerlink" href="#Defining-the-hypothesis" title="Permalink to this headline">¶</a></h2>
<p>Next, we’ll create a new Hypothesis object representing the hypothesis that planets within one region of space are more likely to have atmospheric water vapor than those outside of it. Since we do not know the planets’ sizes, the only independent variable is the distance from the star modulated by the stellar luminosity, called <code class="docutils literal notranslate"><span class="pre">a_eff</span></code> (this is already calculated). Likewise, the dependent variable is the presence or absence of water vapor, called <code class="docutils literal notranslate"><span class="pre">has_H2O</span></code>, which is either 0 or 1. The
relationship between these values is parameterized by <code class="docutils literal notranslate"><span class="pre">a_inner</span></code> (the inner edge of the habitable zone in AU), <code class="docutils literal notranslate"><span class="pre">delta_a</span></code> (the width in AU), <code class="docutils literal notranslate"><span class="pre">f_HZ</span></code> (the fraction of HZ planets with H2O), and <code class="docutils literal notranslate"><span class="pre">df_notHZ</span></code> (the fraction of non-HZ planets with H2O <em>divided by</em> <code class="docutils literal notranslate"><span class="pre">f_HZ</span></code>). By defining the four parameters in this way, we can easily avoid parameter combinations inconsistent with our hypothesis (such as the fraction of non-HZ planets with H2O being higher than <code class="docutils literal notranslate"><span class="pre">f_HZ</span></code> planets).</p>
<p>For compatibility reasons, the names of the independent variables, parameters, and dependent variables must be specified in the function signature as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define the hypothesis in functional form with the appropriate annotations</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">theta</span><span class="p">:(</span><span class="s1">&#39;a_inner&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_a&#39;</span><span class="p">,</span> <span class="s1">&#39;f_HZ&#39;</span><span class="p">,</span> <span class="s1">&#39;df_notHZ&#39;</span><span class="p">),</span> <span class="n">X</span><span class="p">:(</span><span class="s1">&#39;a_eff&#39;</span><span class="p">,))</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">,):</span>
    <span class="n">a_inner</span><span class="p">,</span> <span class="n">delta_a</span><span class="p">,</span> <span class="n">f_HZ</span><span class="p">,</span> <span class="n">df_notHZ</span> <span class="o">=</span> <span class="n">theta</span>
    <span class="n">in_HZ</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">a_inner</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">a_inner</span> <span class="o">+</span> <span class="n">delta_a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">in_HZ</span> <span class="o">*</span> <span class="n">f_HZ</span> <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="n">in_HZ</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_HZ</span><span class="o">*</span><span class="n">df_notHZ</span>
</pre></div>
</div>
</div>
<p>In addition, we must consider the prior probability distribution of these parameters. Conservatively, we suppose the inner edge might extend far inward, or be slightly farther from the Sun than Earth, and that the HZ could be very narrow or very wide. Similarly, the fraction of planets with water vapor in the HZ and outside of it could span many orders of magnitude. We therefore choose to impose log-uniform prior distributions on these parameters across the following ranges:</p>
<p>0.1 &lt; <code class="docutils literal notranslate"><span class="pre">a_inner</span></code> &lt; 2 AU</p>
<p>0.01 &lt; <code class="docutils literal notranslate"><span class="pre">delta_a</span></code> &lt; 10 AU</p>
<p>0 &lt; <code class="docutils literal notranslate"><span class="pre">f_HZ</span></code> &lt; 1</p>
<p>0 &lt; <code class="docutils literal notranslate"><span class="pre">f_notHZ</span></code> &lt; 1</p>
<p>After deciding on the bounds, we can initialize the Hypothesis object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="n">h_HZ</span> <span class="o">=</span> <span class="n">Hypothesis</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>We also need to define the null hypothesis against which <code class="docutils literal notranslate"><span class="pre">h_HZ</span></code> is to be compared. The null hypothesis says that the fraction of planets with water vapor is independent of their orbits - this is a one parameter hypothesis where <code class="docutils literal notranslate"><span class="pre">f_H2O</span></code>, the fraction of planets with water vapor, is the only parameter. Again, the prior distribution on <code class="docutils literal notranslate"><span class="pre">f_H2O</span></code> should be broad (0 to 1) and log-uniform in shape. We can define this null hypothesis and attach it to <code class="docutils literal notranslate"><span class="pre">h_HZ</span></code> as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">f_null</span><span class="p">(</span><span class="n">theta</span><span class="p">:(</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">,),</span> <span class="n">X</span><span class="p">:(</span><span class="s1">&#39;a_eff&#39;</span><span class="p">,))</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="s1">&#39;has_H2O&#39;</span><span class="p">,):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="n">bounds_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="n">h_HZ</span><span class="o">.</span><span class="n">h_null</span> <span class="o">=</span> <span class="n">Hypothesis</span><span class="p">(</span><span class="n">f_null</span><span class="p">,</span> <span class="n">bounds_null</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,))</span>
</pre></div>
</div>
</div>
<p>Now that the Hypothesis has been formed, we can formally test it using our simulated dataset. The <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method will automatically extract the appropriate variables from the data and estimate the Bayesian evidence for both the hypothesis and null hypothesis using nested sampling. It will return the difference between the two i.e. the evidence in favor of the habitable zone hypothesis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">h_HZ</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The evidence in favor of the hypothesis is: dlnZ = </span><span class="si">{:.1f}</span><span class="s2"> (corresponds to p = </span><span class="si">{:.1E}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;dlnZ&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;dlnZ&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The evidence in favor of the hypothesis is: dlnZ = 17.5 (corresponds to p = 2.4E-08)
</pre></div></div>
</div>
<p>Generally speaking, a result where dlnZ &gt; 3 is considered significant, so this was a succcessful test of the hypothesis.</p>
<p><strong>Note for iPython/Jupyter users:</strong> We will need to reload the <code class="docutils literal notranslate"><span class="pre">generator</span></code> and <code class="docutils literal notranslate"><span class="pre">h_HZ</span></code> objects here to replace the ones you have defined above. These will produce the same results, but the next code block uses the <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> module which is incompatible with functions defined in iPython.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Reload `generator` and `h_HZ`</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span><span class="s1">&#39;imaging&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">bioverse.hypothesis</span> <span class="kn">import</span> <span class="n">h_HZ</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Computing-statistical-power">
<h2>Computing statistical power<a class="headerlink" href="#Computing-statistical-power" title="Permalink to this headline">¶</a></h2>
<p>We have not yet tackled the most uncertain part of this analysis: namely, just how common are habitable worlds? The fraction of Earth-sized planets in the habitable zone with atmospheric water vapor could far smaller than the assumed 75%, in which case it might be impossible to test the habitable zone hypothesis. To quantify the importance of this assumption, we will need to repeat the previous analysis several times with different values of <code class="docutils literal notranslate"><span class="pre">f_water_habitable</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">analysis</span></code> module enables this through its <code class="docutils literal notranslate"><span class="pre">test_hypothesis_grid()</span></code> function, which loops the planet simulation, survey simulation, and hypothesis test routines over a grid of input values. Let’s use it to iterate over values of <code class="docutils literal notranslate"><span class="pre">f_water_habitable</span></code> ranging from 1% to 100%. For each value, we will repeat the analysis 20 times to average over Poisson noise.</p>
<p>This may take a few minutes. To speed things up, we will run 8 processes in parallel (you may need to change this number for an older CPU).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f_water_habitable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">test_hypothesis_grid</span><span class="p">(</span><span class="n">h_HZ</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">survey</span><span class="p">,</span> <span class="n">f_water_habitable</span><span class="o">=</span><span class="n">f_water_habitable</span><span class="p">,</span> <span class="n">t_total</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="mf">365.25</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 200/200 [01:43&lt;00:00,  1.93it/s]
</pre></div></div>
</div>
<p>Now, let’s plot the average Bayesian evidence for the hypothesis as a function of <code class="docutils literal notranslate"><span class="pre">f_water_habitable</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_water_habitable</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;dlnZ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fraction of EECs with H2O&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta$lnZ&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_Example1_24_0.svg" src="../_images/Notebooks_Example1_24_0.svg" /></div>
</div>
<p>A more useful metric than the average Bayesian evidence is the survey’s “statistical power”, which is the likelihood that the survey could successfully test the hypothesis under a certain set of assumptions. Run this cell to plot the statistical power versus the fraction of EECs with water vapor.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">power</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">compute_statistical_power</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;dlnZ&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_water_habitable</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fraction of EECs with H2O&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Statistical power&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_Example1_26_0.svg" src="../_images/Notebooks_Example1_26_0.svg" /></div>
</div>
<p>We can see that a LUVOIR-like survey will be able to determine the existence of the habitable zone - but only if habitable planets are relatively common.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Example2.html" class="btn btn-neutral float-right" title="Example 2: Detecting the age-oxygen correlation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="GettingStarted2.html" class="btn btn-neutral float-left" title="Tutorial 2: Simulating survey datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Alex Bixel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
  
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search {
    display: block;
    width: 300px;
    padding: .809em;
    margin-bottom: .809em;
    z-index: 200;
    background-color: #0b750a;
    text-align: center;
    color: #fcfcfc;
    }
    .wy-nav-top {
      background: #0b750a;
    }
    
    .wy-menu-vertical header, .wy-menu-vertical p.caption {
    color: #0b750a;
    line-height: 32px;
    font-weight: 700;
    text-transform: uppercase;
    font-size: 85%;
    white-space: nowrap;
}

html.writer-html4 .rst-content dl:not(.docutils) > dt, html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple) > dt {
    display: table;
    margin: 6px 0;
        margin-top: 6px;
    font-size: 90%;
    line-height: normal;
    background: #edffed;
    color: #0b750a;
    border-top: 3px solid #0b750a;
    padding: 6px;
    position: relative;
}

  a {
    color: #0b750a;
    text-decoration: none;
    cursor: pointer;
}

.wy-table-responsive table td, .wy-table-responsive table th {
    white-space: normal;
}

  </style>
  
  
  


</body>
</html>